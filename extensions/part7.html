<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Part7 AsyncJob extension | Libreoffice Blog</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../extensions/part8.html" />
    
    
    <link rel="prev" href="../extensions/part6.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    <div class="book" data-level="4.8" data-basepath=".." data-revision="Tue Nov 08 2016 06:25:12 GMT+0530 (IST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="patches/index.html">
            
                
                    <a href="../patches/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        patches
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="patches/rsu.html">
            
                
                    <a href="../patches/rsu.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Red squiggly underline bug
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="calcarch/index.html">
            
                
                    <a href="../calcarch/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Calc architecture
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="calcarch/overview.html">
            
                
                    <a href="../calcarch/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        overview
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="calcarch/core.html">
            
                
                    <a href="../calcarch/core.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        core
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="calcarch/ui.html">
            
                
                    <a href="../calcarch/ui.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        ui
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="calcarch/filter.html">
            
                
                    <a href="../calcarch/filter.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        filter
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="misc/index.html">
            
                
                    <a href="../misc/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Libreoffice misc
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="misc/devsetup.html">
            
                
                    <a href="../misc/devsetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        devsetup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="misc/sdksetup.html">
            
                
                    <a href="../misc/sdksetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        sdksetup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="misc/devserver.html">
            
                
                    <a href="../misc/devserver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        devserver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="misc/bibisect.html">
            
                
                    <a href="../misc/bibisect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        bibisect
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="misc/mdds.html">
            
                
                    <a href="../misc/mdds.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        mdds
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="misc/namespaces.html">
            
                
                    <a href="../misc/namespaces.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        namespaces
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="misc/patchchecklist.html">
            
                
                    <a href="../misc/patchchecklist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        patchchecklist
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="extensions/index.html">
            
                
                    <a href="../extensions/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        LibreOffice extensions
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="extensions/prefaq.html">
            
                
                    <a href="../extensions/prefaq.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        PreFAQ
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="extensions/part1.html">
            
                
                    <a href="../extensions/part1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Part1 UNO Intro
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="extensions/part2.html">
            
                
                    <a href="../extensions/part2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Part2 Remote Calc
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="extensions/part3.html">
            
                
                    <a href="../extensions/part3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Part3 UNO communication
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="extensions/part4.html">
            
                
                    <a href="../extensions/part4.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Part4 Simple component
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="extensions/part5.html">
            
                
                    <a href="../extensions/part5.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Part5 Addon
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="extensions/part6.html">
            
                
                    <a href="../extensions/part6.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Part6 ProtocolHandler extension
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="4.8" data-path="extensions/part7.html">
            
                
                    <a href="../extensions/part7.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        Part7 AsyncJob extension
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="extensions/part8.html">
            
                
                    <a href="../extensions/part8.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                        Part8 SingletonComponent
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="extensions/part9.html">
            
                
                    <a href="../extensions/part9.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.10.</b>
                        
                        Part9 ContextMenu
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Libreoffice Blog</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="libreoffice-extension-development-with-c-part-7-asyncjob-component">Libreoffice extension development with C++ - Part 7 - AsyncJob Component.</h1>
<h3 id="audience-selection">Audience selection</h3>
<ol>
<li>Audience type <strong><a href="index.html">AUD-C</a></strong> can jump directly to <strong><a href="#prebuilt">Test the prebuilt extension</a></strong></li>
<li>Audience type <strong><a href="index.html">AUD-B</a></strong> can jump directly to <strong><a href="#buildsec">Download, build and test the extension</a></strong></li>
</ol>
<hr>
<p>In this part we are going to see a more flexible alternative to ProtocolHandler component we say in <a href="part6.html">Part6</a>.
A <em>job</em> in LO is a UNO component that can be executed by the job execution environment upon an event. The job is protected from office termination.
The job component must implement the service <code>com.sun.star.task.Job</code> if it needs to block the thread in which it is executed or implement <code>com.sun.star.task.AsyncJob</code> if needed to be executed in a separate thread. If a job component implements both of these services, then the synchronous service is preferred by the job execution environment. Note that synchronous jobs should not display any user interfaces from it as repaint errors and threading issues will occur. In this part we will focus on implementing <code>AsyncJob</code> service.</p>
<p>The <code>AsyncJob</code> service supports the interface <code>com::sun::star::task::XAsyncJob</code> which has only one method <code>executeAsync()</code> with the following signature :</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">executeAsync</span><span class="hljs-params">(
     [in] sequence&lt; com::sun::star::beans::NamedValue &gt; Arguments,
     [in] XJobListener Listener)</span>
          <span class="hljs-title">raises</span><span class="hljs-params">( com::sun::star::lang::IllegalArgumentException )</span></span>;
</code></pre>
<p>The <code>Arguments</code> paramter is a sequence of <code>NamedValue</code> structs. This contains information on the environment where the job is running, ie it tells if the job was created by the job executor or the dispatch framework or global event broadcaster service and possibly provides a document model or frame to work with.</p>
<p>As we are already familiar with writing components, we focus on just writing the <code>executeAsync()</code> method and methods supporting it.</p>
<p>Lets declare our class <code>AsyncJobImpl</code> which implements <code>XAsyncJob</code> interface.</p>
<pre><code class="lang-cpp"><span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> IMPLEMENTATION_NAME &quot;inco.niocs.test.AsyncJobImpl&quot;</span>

<span class="hljs-keyword">class</span> AsyncJobImpl : <span class="hljs-keyword">public</span> cppu::WeakImplHelper2
&lt;
    com::sun::star::task::XAsyncJob,
    com::sun::star::lang::XServiceInfo
&gt;
{

<span class="hljs-keyword">private</span>:
    ::com::sun::star::uno::Reference&lt; ::com::sun::star::uno::XComponentContext &gt; mxContext;

<span class="hljs-keyword">public</span>:

    AsyncJobImpl( <span class="hljs-keyword">const</span> ::com::sun::star::uno::Reference&lt; ::com::sun::star::uno::XComponentContext &gt; &amp;rxContext )
        : mxContext( rxContext )
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DEBUG&gt;&gt;&gt; Created AsyncJobImpl object : %p\n&quot;</span>, <span class="hljs-keyword">this</span>); fflush(stdout);
    }

    <span class="hljs-comment">// XAsyncJob methods</span>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> SAL_CALL <span class="hljs-title">executeAsync</span><span class="hljs-params">( <span class="hljs-keyword">const</span> ::com::sun::star::uno::Sequence&lt; ::com::sun::star::beans::NamedValue &gt;&amp; rArgs,
                                        <span class="hljs-keyword">const</span> ::com::sun::star::uno::Reference&lt; ::com::sun::star::task::XJobListener &gt;&amp; rxListener )</span>
        <span class="hljs-title">throw</span><span class="hljs-params">(::com::sun::star::lang::IllegalArgumentException,
              ::com::sun::star::uno::RuntimeException)</span> override</span>;

    <span class="hljs-comment">// XServiceInfo methods</span>
    <span class="hljs-keyword">virtual</span> ::rtl::<span class="hljs-function">OUString SAL_CALL <span class="hljs-title">getImplementationName</span><span class="hljs-params">()</span>
        <span class="hljs-title">throw</span> <span class="hljs-params">(::com::sun::star::uno::RuntimeException)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> sal_Bool SAL_CALL <span class="hljs-title">supportsService</span><span class="hljs-params">( <span class="hljs-keyword">const</span> ::rtl::OUString&amp; aServiceName )</span>
        <span class="hljs-title">throw</span> <span class="hljs-params">(::com::sun::star::uno::RuntimeException)</span></span>;
    <span class="hljs-keyword">virtual</span> ::com::sun::star::uno::Sequence&lt; ::rtl::OUString &gt; <span class="hljs-function">SAL_CALL <span class="hljs-title">getSupportedServiceNames</span><span class="hljs-params">()</span>
        <span class="hljs-title">throw</span> <span class="hljs-params">(::com::sun::star::uno::RuntimeException)</span></span>;

    <span class="hljs-comment">// A struct to store some job related info when executeAsync() is called</span>
    <span class="hljs-keyword">struct</span> AsyncJobImplInfo
    {
        ::rtl::OUString aEnvType;
        ::rtl::OUString aEventName;
        ::rtl::OUString aAlias;
        ::com::sun::star::uno::Reference&lt; ::com::sun::star::frame::XFrame &gt; xFrame;

        ::rtl::OUString aGenericConfigList, aJobConfigList, aEnvironmentList, aDynamicDataList;
    };

<span class="hljs-keyword">private</span>:

    ::rtl::<span class="hljs-function">OUString <span class="hljs-title">validateGetInfo</span><span class="hljs-params">( <span class="hljs-keyword">const</span> ::com::sun::star::uno::Sequence&lt; ::com::sun::star::beans::NamedValue &gt;&amp; rArgs,
                                     <span class="hljs-keyword">const</span> ::com::sun::star::uno::Reference&lt; ::com::sun::star::task::XJobListener &gt;&amp; rxListener,
                                     AsyncJobImplInfo&amp; rJobInfo )</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">formatOutArgs</span><span class="hljs-params">( <span class="hljs-keyword">const</span> ::com::sun::star::uno::Sequence&lt; ::com::sun::star::beans::NamedValue &gt;&amp; rList,
                        <span class="hljs-keyword">const</span> ::rtl::OUString aListName,
                        ::rtl::OUString&amp; rFormattedList )</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">writeInfoToSheet</span><span class="hljs-params">( <span class="hljs-keyword">const</span> AsyncJobImplInfo&amp; rJobInfo )</span></span>;
};
</code></pre>
<p>Note that we declared three private methods which help us in implementing <code>executeAsync()</code> interface method.
<code>validateGetInfo()</code> takes the arguments received from <code>executeAsync()</code> and validates it and extracts needed information and fills it into a struct <code>AsyncJobImplInfo</code> which has the following fields :</p>
<ol>
<li><em>aEnvType</em> : This stores the type of enviroment. For instance, if our job was invoked from a menu/toolbar then this will have the string &quot;DISPATCH&quot;.</li>
<li><em>aEventName</em> : This indicate the name of the event if the job was called in response to an event.</li>
<li><em>aAlias</em> : A Job can have an alias and jobs can be called via its alias. If this is the case then this member will contain the alias name used.</li>
<li><em>xFrame</em> : This stores the Frame object passed on to <code>executeAsync()</code> for us to manipulate the UI/Model.</li>
<li><em>aGenericConfigList</em> : Contains stringified version of the sublist in <code>executeAsync()</code>&apos;s with name <code>Config</code>.</li>
<li><em>aJobConfigList</em> : Contains stringified version of the sublist in <code>executeAsync()</code>&apos;s with name <code>JobConfig</code>.</li>
<li><em>aEnvironmentList</em> : Contains stringified version of the sublist in <code>executeAsync()</code>&apos;s with name <code>Environment</code>.</li>
<li><em>aDynamicDataList</em> : Contains stringified version of the sublist in <code>executeAsync()</code>&apos;s with name <code>DynamicData</code>.</li>
</ol>
<p><code>formatOutArgs()</code> takes a sequence of <code>NamedValue</code> and stringifies it. <code>writeInfoToSheet()</code> takes the info struct object <code>AsyncJobImplInfo</code> and writes all info to <code>Sheet1</code> of the current Frame.
<code>executeAsync()</code> methods also has to call the method <code>jobFinished()</code> of the <code>XJobListener</code> object it received just before exiting the function.</p>
<p>Following are the implementations of these methods :</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// XAsyncJob method implementations</span>

<span class="hljs-keyword">void</span> SAL_CALL AsyncJobImpl::executeAsync( <span class="hljs-keyword">const</span> Sequence&lt;NamedValue&gt;&amp; rArgs,
                                          <span class="hljs-keyword">const</span> Reference&lt;XJobListener&gt;&amp; rxListener )
    <span class="hljs-keyword">throw</span>(IllegalArgumentException, RuntimeException)
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DEBUG&gt;&gt;&gt; Called executeAsync() : this = %p\n&quot;</span>, <span class="hljs-keyword">this</span>); fflush(stdout);

    AsyncJobImplInfo aJobInfo;
    OUString aErr = validateGetInfo( rArgs, rxListener, aJobInfo );
    <span class="hljs-keyword">if</span> ( !aErr.isEmpty() )
    {
        sal_Int16 nArgPos = <span class="hljs-number">0</span>;        
        <span class="hljs-keyword">if</span> ( aErr.startsWith( <span class="hljs-string">&quot;Listener&quot;</span> ) )
            nArgPos = <span class="hljs-number">1</span>;

        <span class="hljs-keyword">throw</span> IllegalArgumentException(
            aErr,
            <span class="hljs-comment">// resolve to XInterface reference:</span>
            <span class="hljs-keyword">static_cast</span>&lt; ::cppu::OWeakObject * &gt;(<span class="hljs-keyword">this</span>),
            nArgPos ); <span class="hljs-comment">// argument pos</span>
    }

    writeInfoToSheet( aJobInfo );

    <span class="hljs-keyword">bool</span> bIsDispatch = aJobInfo.aEnvType.equalsAscii(<span class="hljs-string">&quot;DISPATCH&quot;</span>);
    Sequence&lt;NamedValue&gt; aReturn( ( bIsDispatch ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> ) );

    <span class="hljs-keyword">if</span> ( bIsDispatch )
    {
        aReturn[<span class="hljs-number">0</span>].Name  = <span class="hljs-string">&quot;SendDispatchResult&quot;</span>;
        DispatchResultEvent aResultEvent;
        aResultEvent.Source = (cppu::OWeakObject*)<span class="hljs-keyword">this</span>;
        aResultEvent.State = DispatchResultState::SUCCESS;
        aResultEvent.Result &lt;&lt;= <span class="hljs-keyword">true</span>;
        aReturn[<span class="hljs-number">0</span>].Value &lt;&lt;= aResultEvent;
    }

    rxListener-&gt;jobFinished( Reference&lt;com::sun::star::task::XAsyncJob&gt;(<span class="hljs-keyword">this</span>), makeAny(aReturn));

}


OUString AsyncJobImpl::validateGetInfo( <span class="hljs-keyword">const</span> Sequence&lt;NamedValue&gt;&amp; rArgs,
                                        <span class="hljs-keyword">const</span> Reference&lt;XJobListener&gt;&amp; rxListener,
                                        AsyncJobImpl::AsyncJobImplInfo&amp; rJobInfo )
{
    <span class="hljs-keyword">if</span> ( !rxListener.is() )
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Listener : invalid listener&quot;</span>;

    <span class="hljs-comment">// Extract all sublists from rArgs.</span>
    Sequence&lt;NamedValue&gt; aGenericConfig;
    Sequence&lt;NamedValue&gt; aJobConfig;
    Sequence&lt;NamedValue&gt; aEnvironment;
    Sequence&lt;NamedValue&gt; aDynamicData;

    sal_Int32 nNumNVs = rArgs.getLength();
    <span class="hljs-keyword">for</span> ( sal_Int32 nIdx = <span class="hljs-number">0</span>; nIdx &lt; nNumNVs; ++nIdx )
    {
        <span class="hljs-keyword">if</span> ( rArgs[nIdx].Name.equalsAscii(<span class="hljs-string">&quot;Config&quot;</span>) )
        {
            rArgs[nIdx].Value &gt;&gt;= aGenericConfig;
            formatOutArgs( aGenericConfig, <span class="hljs-string">&quot;Config&quot;</span>, rJobInfo.aGenericConfigList );
        }
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">( rArgs[nIdx].Name.equalsAscii(&quot;JobConfig&quot;)</span> )
        </span>{
            rArgs[nIdx].Value &gt;&gt;= aJobConfig;
            formatOutArgs( aJobConfig, <span class="hljs-string">&quot;JobConfig&quot;</span>, rJobInfo.aJobConfigList );
        }
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">( rArgs[nIdx].Name.equalsAscii(&quot;Environment&quot;)</span> )
        </span>{
            rArgs[nIdx].Value &gt;&gt;= aEnvironment;
            formatOutArgs( aEnvironment, <span class="hljs-string">&quot;Environment&quot;</span>, rJobInfo.aEnvironmentList );
        }
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">( rArgs[nIdx].Name.equalsAscii(&quot;DynamicData&quot;)</span> )
        </span>{
            rArgs[nIdx].Value &gt;&gt;= aDynamicData;
            formatOutArgs( aDynamicData, <span class="hljs-string">&quot;DynamicData&quot;</span>, rJobInfo.aDynamicDataList );
        }
    }

    <span class="hljs-comment">// Analyze the environment info. This sub list is the only guaranteed one!</span>
    <span class="hljs-keyword">if</span> ( !aEnvironment.hasElements() )
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Args : no environment&quot;</span>;

    sal_Int32 nNumEnvEntries = aEnvironment.getLength();
    <span class="hljs-keyword">for</span> ( sal_Int32 nIdx = <span class="hljs-number">0</span>; nIdx &lt; nNumEnvEntries; ++nIdx )
    {
        <span class="hljs-keyword">if</span> ( aEnvironment[nIdx].Name.equalsAscii(<span class="hljs-string">&quot;EnvType&quot;</span>) )
            aEnvironment[nIdx].Value &gt;&gt;= rJobInfo.aEnvType;

        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">( aEnvironment[nIdx].Name.equalsAscii(&quot;EventName&quot;)</span> )
            aEnvironment[nIdx].Value &gt;&gt;</span>= rJobInfo.aEventName;

        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">( aEnvironment[nIdx].Name.equalsAscii(&quot;Frame&quot;)</span> )
            aEnvironment[nIdx].Value &gt;&gt;</span>= rJobInfo.xFrame;
    }

    <span class="hljs-comment">// Further the environment property &quot;EnvType&quot; is required as minimum.</span>

    <span class="hljs-keyword">if</span> ( rJobInfo.aEnvType.isEmpty() ||
         ( ( !rJobInfo.aEnvType.equalsAscii(<span class="hljs-string">&quot;EXECUTOR&quot;</span>) ) &amp;&amp;
           ( !rJobInfo.aEnvType.equalsAscii(<span class="hljs-string">&quot;DISPATCH&quot;</span>) )
             )        )
        <span class="hljs-keyword">return</span> OUString(<span class="hljs-string">&quot;Args : \&quot;&quot;</span> + rJobInfo.aEnvType + <span class="hljs-string">&quot;\&quot; isn&apos;t a valid value for EnvType&quot;</span>);

    <span class="hljs-comment">// Analyze the set of shared config data.</span>
    <span class="hljs-keyword">if</span> ( aGenericConfig.hasElements() )
    {
        sal_Int32 nNumGenCfgEntries = aGenericConfig.getLength();
        <span class="hljs-keyword">for</span> ( sal_Int32 nIdx = <span class="hljs-number">0</span>; nIdx &lt; nNumGenCfgEntries; ++nIdx )
            <span class="hljs-keyword">if</span> ( aGenericConfig[nIdx].Name.equalsAscii(<span class="hljs-string">&quot;Alias&quot;</span>) )
                aGenericConfig[nIdx].Value &gt;&gt;= rJobInfo.aAlias;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;
}


<span class="hljs-keyword">void</span> AsyncJobImpl::formatOutArgs( <span class="hljs-keyword">const</span> Sequence&lt;NamedValue&gt;&amp; rList,
                                  <span class="hljs-keyword">const</span> OUString aListName,
                                  OUString&amp; rFormattedList )
{
    <span class="hljs-function">OUStringBuffer <span class="hljs-title">aBuf</span><span class="hljs-params">( 512 )</span></span>;
    aBuf.append(<span class="hljs-string">&quot;List \&quot;&quot;</span> + aListName + <span class="hljs-string">&quot;\&quot; : &quot;</span>);
    <span class="hljs-keyword">if</span> ( !rList.hasElements() )
        aBuf.append(<span class="hljs-string">&quot;0 items&quot;</span>);
    <span class="hljs-keyword">else</span>
    {
        sal_Int32 nNumEntries = rList.getLength();
        aBuf.append(nNumEntries).append(<span class="hljs-string">&quot; item(s) : { &quot;</span>);
        <span class="hljs-keyword">for</span> ( sal_Int32 nIdx = <span class="hljs-number">0</span>; nIdx &lt; nNumEntries; ++nIdx )
        {
            OUString aVal;
            rList[nIdx].Value &gt;&gt;= aVal;
            aBuf.append(<span class="hljs-string">&quot;\&quot;&quot;</span> + rList[nIdx].Name + <span class="hljs-string">&quot;\&quot; : \&quot;&quot;</span> + aVal + <span class="hljs-string">&quot;\&quot;, &quot;</span>);
        }
        aBuf.append(<span class="hljs-string">&quot; }&quot;</span>);
    }

    rFormattedList = aBuf.toString();
}


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WriteStringsToSheet</span><span class="hljs-params">( <span class="hljs-keyword">const</span> Reference&lt; XFrame &gt; &amp;rxFrame, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;OUString&gt;&amp; rStrings )</span>
</span>{
    <span class="hljs-keyword">if</span> ( !rxFrame.is() )
        <span class="hljs-keyword">return</span>;

    Reference&lt; XController &gt; xCtrl = rxFrame-&gt;getController();
    <span class="hljs-keyword">if</span> ( !xCtrl.is() )
        <span class="hljs-keyword">return</span>;

    Reference&lt; XModel &gt; xModel = xCtrl-&gt;getModel();
    <span class="hljs-keyword">if</span> ( !xModel.is() )
        <span class="hljs-keyword">return</span>;

    Reference&lt; XSpreadsheetDocument &gt; xSpreadsheetDocument( xModel, UNO_QUERY );
    <span class="hljs-keyword">if</span> ( !xSpreadsheetDocument.is() )
        <span class="hljs-keyword">return</span>;

    Reference&lt; XSpreadsheets &gt; xSpreadsheets = xSpreadsheetDocument-&gt;getSheets();
    <span class="hljs-keyword">if</span> ( !xSpreadsheets-&gt;hasByName(<span class="hljs-string">&quot;Sheet1&quot;</span>) )
        <span class="hljs-keyword">return</span>;

    Any aSheet = xSpreadsheets-&gt;getByName(<span class="hljs-string">&quot;Sheet1&quot;</span>);

    Reference&lt; XSpreadsheet &gt; xSpreadsheet( aSheet, UNO_QUERY );

    size_t nNumStrings = rStrings.size();
    <span class="hljs-keyword">for</span> ( size_t nIdx = <span class="hljs-number">0</span>; nIdx &lt; nNumStrings; ++nIdx )
    {
        Reference&lt; XCell &gt; xCell = xSpreadsheet-&gt;getCellByPosition(<span class="hljs-number">0</span>, nIdx);
        xCell-&gt;setFormula(rStrings[nIdx]);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DEBUG&gt;&gt;&gt; Wrote \&quot;%s\&quot; to Cell A%d\n&quot;</span>,
               OUStringToOString( rStrings[nIdx], RTL_TEXTENCODING_ASCII_US ).getStr(), nIdx); fflush(stdout);
    }
}

<span class="hljs-keyword">void</span> AsyncJobImpl::writeInfoToSheet( <span class="hljs-keyword">const</span> AsyncJobImpl::AsyncJobImplInfo&amp; rJobInfo )
{
    <span class="hljs-keyword">if</span> ( !rJobInfo.xFrame.is() )
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DEBUG&gt;&gt;&gt; Frame passed is null, cannot write to sheet !\n&quot;</span>);
        fflush(stdout);
    }
    std::<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;OUString&gt;</span> aStrList = {
        <span class="hljs-string">&quot;EnvType = &quot;</span> + rJobInfo.aEnvType,
        <span class="hljs-string">&quot;EventName = &quot;</span> + rJobInfo.aEventName,
        <span class="hljs-string">&quot;Alias = &quot;</span> + rJobInfo.aAlias,
        rJobInfo.aGenericConfigList,
        rJobInfo.aJobConfigList,
        rJobInfo.aEnvironmentList,
        rJobInfo.aDynamicDataList
    };

    WriteStringsToSheet( rJobInfo.xFrame, aStrList );
}
</code></pre>
<p>A Job component can be called from the menu or toolbar buttons using any of the three following methods :</p>
<ol>
<li>By <em>Event name</em> : A Job component can be configured to be called when a particular event is raised. A UI element can raise an event by using a URL of the form <code>vnd.sun.star.job:event=&lt;EVENTNAME&gt;</code>, where <code>EVENTNAME</code> can be any of the <a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/WritingUNO/Jobs/List_of_Supported_Events" target="_blank">standard events</a> or a custom event registered by the Job component.</li>
<li>By <em>Alias</em> : A Job can be called from the UI element by its alias by using the URL of the form <code>vnd.sun.star.job:alias=&lt;ALIAS_OF_THE_JOB&gt;</code>.</li>
<li>By <em>Implementation name</em> : A Job can be called using its implementation name by using URL of form : <code>vnd.sun.star.job:service=&lt;IMPLEMENTAION_NAME&gt;</code> example :  <code>vnd.sun.star.job:service=inco.niocs.test.AsyncJobImpl</code>.</li>
</ol>
<p>We specify our job&apos;s alias, attached events in an xml file called <code>Job.xcu</code>.</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">oor:component-data</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Jobs&quot;</span> <span class="hljs-attribute">oor:package</span>=<span class="hljs-value">&quot;org.openoffice.Office&quot;</span> <span class="hljs-attribute">xmlns:oor</span>=<span class="hljs-value">&quot;http://openoffice.org/2001/registry&quot;</span> <span class="hljs-attribute">xmlns:xs</span>=<span class="hljs-value">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Jobs&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--            vvvvvvvvvvv    AsyncJobImpl is the alias --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;AsyncJobImpl&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Service&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>inco.niocs.test.AsyncJobImpl<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Events&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--
        &lt;node oor:name=&quot;onFirstVisibleTask&quot; oor:op=&quot;modify&quot;&gt;
            &lt;node oor:name=&quot;JobList&quot;&gt;
                &lt;node oor:name=&quot;AsyncJobImpl&quot; oor:op=&quot;replace&quot;/&gt;
            &lt;/node&gt;
        &lt;/node&gt;
        --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;onMyOwnJobEvent&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;JobList&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;AsyncJobImpl&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">oor:component-data</span>&gt;</span>
</code></pre>
<p>We now add menu entries to call our job in the three different ways discussed before.</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">oor:component-data</span> <span class="hljs-attribute">xmlns:oor</span>=<span class="hljs-value">&quot;http://openoffice.org/2001/registry&quot;</span> <span class="hljs-attribute">xmlns:xs</span>=<span class="hljs-value">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Addons&quot;</span> <span class="hljs-attribute">oor:package</span>=<span class="hljs-value">&quot;org.openoffice.Office&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;AddonUI&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;OfficeMenuBar&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;inco.niocs.test.asyncjobimpl.menu&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Title&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">value</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">value</span> <span class="hljs-attribute">xml:lang</span>=<span class="hljs-value">&quot;en-US&quot;</span>&gt;</span>Add-On example<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Submenu&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;m1&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;URL&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>vnd.sun.star.job:alias=AsyncJobImpl<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Title&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span> <span class="hljs-attribute">xml:lang</span>=<span class="hljs-value">&quot;en-US&quot;</span>&gt;</span>AsyncJob (ALIAS)<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Target&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>_self<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Context&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>com.sun.star.sheet.SpreadsheetDocument<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;m2&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;URL&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>vnd.sun.star.job:event=onMyOwnJobEvent<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Title&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span> <span class="hljs-attribute">xml:lang</span>=<span class="hljs-value">&quot;en-US&quot;</span>&gt;</span>AsyncJob (EVENT)<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Target&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>_self<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Context&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>com.sun.star.sheet.SpreadsheetDocument<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">node</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;m3&quot;</span> <span class="hljs-attribute">oor:op</span>=<span class="hljs-value">&quot;replace&quot;</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;URL&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>vnd.sun.star.job:service=inco.niocs.test.AsyncJobImpl<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Title&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span> <span class="hljs-attribute">xml:lang</span>=<span class="hljs-value">&quot;en-US&quot;</span>&gt;</span>AsyncJob (SERVICE)<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Target&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>_self<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-title">prop</span> <span class="hljs-attribute">oor:name</span>=<span class="hljs-value">&quot;Context&quot;</span> <span class="hljs-attribute">oor:type</span>=<span class="hljs-value">&quot;xs:string&quot;</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>com.sun.star.sheet.SpreadsheetDocument<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-title">prop</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">node</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">oor:component-data</span>&gt;</span>
</code></pre>
<h2 id="-a-name-buildsec-a-download-build-and-test-the-extension"><a name="buildsec"></a>Download, build and test the extension</h2>
<p><strong>Please remember to remove any previous extensions from Part5/Part6 using <code>$LOROOT/instdir/program/unopkg remove</code></strong></p>
<p>The whole project can be downloaded and built by doing :</p>
<pre><code>$ git clone https://github.com/niocs/AsyncJobExtension.git
$ cd AsyncJobExtension
$ make
$ $LOROOT/instdir/program/unopkg add /home/$username/libreoffice5.3_sdk/LINUXexample.out/bin/AsyncJobExtension.oxt
</code></pre><p>To remove the extension, do :</p>
<pre><code>$ $LOROOT/instdir/program/unopkg remove AsyncJobExtension.oxt
</code></pre><p>On running Calc you will notice there are three menu entries inside the menu <code>Add-On example</code> each for triggering our component via three methods :</p>
<ol>
<li>Call via Event name.</li>
<li>Call via Implementation name(service).</li>
<li>Call via Alias.</li>
</ol>
<p>On clicking each of them, Sheet1&apos;s column A will be filled with job environment information. Depending on the menu entry you click, some of the content will be blank.</p>
<p>You will also notice the debug info printed on the terminal on each click. It would look something like :</p>
<pre><code>DEBUG&gt;&gt;&gt; Created AsyncJobImpl object : 0x3e78f10
DEBUG&gt;&gt;&gt; Called executeAsync() : this = 0x3e78f10
DEBUG&gt;&gt;&gt; Wrote &quot;EnvType = DISPATCH&quot; to Cell A0
DEBUG&gt;&gt;&gt; Wrote &quot;EventName = &quot; to Cell A1
DEBUG&gt;&gt;&gt; Wrote &quot;Alias = AsyncJobImpl&quot; to Cell A2
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;Config&quot; : 3 item(s) : { &quot;Alias&quot; : &quot;AsyncJobImpl&quot;, &quot;Service&quot; : &quot;inco.niocs.test.AsyncJobImpl&quot;, &quot;Context&quot; : &quot;&quot;,  }&quot; to Cell A3
DEBUG&gt;&gt;&gt; Wrote &quot;&quot; to Cell A4
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;Environment&quot; : 2 item(s) : { &quot;EnvType&quot; : &quot;DISPATCH&quot;, &quot;Frame&quot; : &quot;&quot;,  }&quot; to Cell A5
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;DynamicData&quot; : 1 item(s) : { &quot;Referer&quot; : &quot;private:user&quot;,  }&quot; to Cell A6
DEBUG&gt;&gt;&gt; Created AsyncJobImpl object : 0x4772690
DEBUG&gt;&gt;&gt; Called executeAsync() : this = 0x4772690
DEBUG&gt;&gt;&gt; Wrote &quot;EnvType = DISPATCH&quot; to Cell A0
DEBUG&gt;&gt;&gt; Wrote &quot;EventName = onMyOwnJobEvent&quot; to Cell A1
DEBUG&gt;&gt;&gt; Wrote &quot;Alias = &quot; to Cell A2
DEBUG&gt;&gt;&gt; Wrote &quot;&quot; to Cell A3
DEBUG&gt;&gt;&gt; Wrote &quot;&quot; to Cell A4
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;Environment&quot; : 3 item(s) : { &quot;EnvType&quot; : &quot;DISPATCH&quot;, &quot;Frame&quot; : &quot;&quot;, &quot;EventName&quot; : &quot;onMyOwnJobEvent&quot;,  }&quot; to Cell A5
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;DynamicData&quot; : 1 item(s) : { &quot;Referer&quot; : &quot;private:user&quot;,  }&quot; to Cell A6
DEBUG&gt;&gt;&gt; Created AsyncJobImpl object : 0x4780a70
DEBUG&gt;&gt;&gt; Called executeAsync() : this = 0x4780a70
DEBUG&gt;&gt;&gt; Wrote &quot;EnvType = DISPATCH&quot; to Cell A0
DEBUG&gt;&gt;&gt; Wrote &quot;EventName = &quot; to Cell A1
DEBUG&gt;&gt;&gt; Wrote &quot;Alias = &quot; to Cell A2
DEBUG&gt;&gt;&gt; Wrote &quot;&quot; to Cell A3
DEBUG&gt;&gt;&gt; Wrote &quot;&quot; to Cell A4
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;Environment&quot; : 2 item(s) : { &quot;EnvType&quot; : &quot;DISPATCH&quot;, &quot;Frame&quot; : &quot;&quot;,  }&quot; to Cell A5
DEBUG&gt;&gt;&gt; Wrote &quot;List &quot;DynamicData&quot; : 1 item(s) : { &quot;Referer&quot; : &quot;private:user&quot;,  }&quot; to Cell A6
</code></pre><p><em>NOTE : From the above we can note that each time a event/trigger is made our class <code>AsyncJobImpl</code> is instantiated.</em></p>
<h2 id="-a-name-prebuilt-a-test-the-prebuilt-extension"><a name="prebuilt"></a>Test the prebuilt extension</h2>
<p><strong>Please remember to remove any previous extension from Part5/Part6 using <code>unopkg remove</code>.</strong></p>
<p>Download the extension as :</p>
<pre><code>$ git clone https://github.com/niocs/AsyncJobExtension.git
$ cd AsyncJobExtension
</code></pre><p>In <code>AsyncJobExtension</code> directory you will see a file called <code>AsyncJobExtension.oxt</code>. This is the prebuilt extension. Install this extension using</p>
<pre><code>$ unopkg add /path/to/AsyncJobExtension.oxt
</code></pre><p>To remove this extension do :</p>
<pre><code>$ unopkg remove AsyncJobExtension.oxt
</code></pre><p>On running Calc you will notice there are three menu entries inside the menu <code>Add-On example</code> each for triggering our component via three methods :</p>
<ol>
<li>Call via Event name.</li>
<li>Call via Implementation name(service).</li>
<li>Call via Alias.</li>
</ol>
<p>On clicking each of them, Sheet1&apos;s column A will be filled with job environment information. Depending on the menu entry you click, some of the content will be blank.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../extensions/part6.html" class="navigation navigation-prev " aria-label="Previous page: Part6 ProtocolHandler extension"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../extensions/part8.html" class="navigation navigation-next " aria-label="Next page: Part8 SingletonComponent"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
