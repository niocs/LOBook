<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Part2 | Libreoffice Blog</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../extensions/part3.html" />
    
    
    <link rel="prev" href="../extensions/part1.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    <div class="book" data-level="4.3" data-basepath=".." data-revision="Mon Oct 17 2016 15:44:32 GMT+0530 (IST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="patches/index.html">
            
                
                    <a href="../patches/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        patches
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="patches/rsu.html">
            
                
                    <a href="../patches/rsu.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Red squiggly underline bug
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="calcarch/index.html">
            
                
                    <a href="../calcarch/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Calc architecture
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="calcarch/overview.html">
            
                
                    <a href="../calcarch/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        overview
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="calcarch/core.html">
            
                
                    <a href="../calcarch/core.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        core
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="calcarch/ui.html">
            
                
                    <a href="../calcarch/ui.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        ui
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="calcarch/filter.html">
            
                
                    <a href="../calcarch/filter.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        filter
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="misc/index.html">
            
                
                    <a href="../misc/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Libreoffice misc
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="misc/devsetup.html">
            
                
                    <a href="../misc/devsetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        devsetup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="misc/sdksetup.html">
            
                
                    <a href="../misc/sdksetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        sdksetup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="misc/devserver.html">
            
                
                    <a href="../misc/devserver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        devserver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="misc/bibisect.html">
            
                
                    <a href="../misc/bibisect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        bibisect
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="misc/mdds.html">
            
                
                    <a href="../misc/mdds.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        mdds
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="misc/namespaces.html">
            
                
                    <a href="../misc/namespaces.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        namespaces
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="misc/patchchecklist.html">
            
                
                    <a href="../misc/patchchecklist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        patchchecklist
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="extensions/index.html">
            
                
                    <a href="../extensions/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        LibreOffice extensions
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="extensions/prefaq.html">
            
                
                    <a href="../extensions/prefaq.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        PreFAQ
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="extensions/part1.html">
            
                
                    <a href="../extensions/part1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Part1
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="4.3" data-path="extensions/part2.html">
            
                
                    <a href="../extensions/part2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Part2
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="extensions/part3.html">
            
                
                    <a href="../extensions/part3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Part3
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="extensions/part4.html">
            
                
                    <a href="../extensions/part4.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Part4
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Libreoffice Blog</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="libreoffice-extension-development-with-c-part-2-working-with-a-spreadsheet-document">Libreoffice extension development with C++ - Part 2 - Working with a Spreadsheet document</h1>
<h3 id="audience-selection">Audience selection</h3>
<ol>
<li>Audience type <strong><a href="index.html">AUD-C</a></strong> can skip this part and start with <a href="part4.html">Part4</a></li>
<li>Audience type <strong><a href="index.html">AUD-B</a></strong> can jump directly to <a href="#buildsec">code download and build/run section</a></li>
</ol>
<hr>
<p>In this part we extend the program developed in Part 1 <a href="https://github.com/niocs/UNOCreateUseObject" target="_blank">code</a>
to manipulate the spreadsheet further.</p>
<ol>
<li><p>we use <code>::cppu::bootstrap()</code> to get the remote office context of a running
office instance</p>
<pre><code class="lang-cpp">Reference&lt; XComponentContext &gt; xContext( ::cppu::bootstrap() );
</code></pre>
</li>
<li><p>Obtain the service manager from the component context</p>
<pre><code class="lang-cpp">Reference&lt; XMultiComponentFactory &gt; xServiceManager = xContext-&gt;getServiceManager();
</code></pre>
</li>
<li><p>Create Desktop service</p>
<pre><code class="lang-cpp">Reference&lt; XInterface &gt; xDesktop = xServiceManager-&gt;createInstanceWithContext( OUString(<span class="hljs-string">&quot;com.sun.star.frame.Desktop&quot;</span>), xContext );
</code></pre>
</li>
<li><p>Get <code>XDesktop2</code> interface from <code>XInterface</code> reference we got in previous step</p>
<pre><code class="lang-cpp">Reference&lt; XDesktop2 &gt; xDesktop2( xDesktop, UNO_QUERY );
</code></pre>
</li>
<li><p>Load a blank spreadsheet document using <code>XDesktop2</code> interface</p>
<pre><code class="lang-cpp">Reference&lt; XComponent &gt; xComponent = xDesktop2-&gt;loadComponentFromURL( OUString( <span class="hljs-string">&quot;private:factory/scalc&quot;</span> ), <span class="hljs-comment">// URL to the ods file                                                                          </span>
                                                                      OUString( <span class="hljs-string">&quot;_blank&quot;</span> ), <span class="hljs-number">0</span>,
                                                                      Sequence &lt; ::com::sun::star::beans::PropertyValue &gt;() );
</code></pre>
<p>Note that the last parameter can be used to describe the properties of the document, and can
use the property names in <a href="http://api.libreoffice.org/docs/idl/ref/servicecom_1_1sun_1_1star_1_1document_1_1MediaDescriptor.html" target="_blank">MediaDescriptor</a>
See below for details on <code>Sequence</code> and <code>PropertyValue</code> types.</p>
</li>
<li><p>In fact the <code>xComponent</code> object we got supports <code>XSpreadsheetDocument</code> interface, but
we need to explicitly convert by letting the compiler know by :</p>
<pre><code class="lang-cpp">Reference&lt; XSpreadsheetDocument &gt; xSpreadsheetDocument(xComponent, UNO_QUERY);
</code></pre>
</li>
<li><p>Get the &quot;collection of spreadsheets&quot; interface <code>XSpreadsheets</code> :</p>
<pre><code class="lang-cpp">Reference&lt; XSpreadsheets &gt; xSpreadsheets = xSpreadsheetDocument-&gt;getSheets();
</code></pre>
</li>
<li><p>Create a new sheet named MySheet</p>
<pre><code class="lang-cpp">xSpreadsheets-&gt;insertNewByName( OUString(<span class="hljs-string">&quot;MySheet&quot;</span>), (<span class="hljs-keyword">short</span>)<span class="hljs-number">0</span> );
</code></pre>
</li>
<li><p>See what is the type of each element in the collection <code>XSpreadsheets</code></p>
<pre><code class="lang-cpp">Type aElemType = xSpreadsheets-&gt;getElementType();
<span class="hljs-built_in">fprintf</span>( stdout, <span class="hljs-string">&quot;\n&gt;&gt;&gt; xSpreadsheets container has elements each of type = %s\n&quot;</span>,                                                                                                                         
         OUStringToOString( aElemType.getTypeName(), RTL_TEXTENCODING_ASCII_US ).getStr() );
</code></pre>
<p>This should print the type as &quot;com.sun.star.sheet.XSpreadsheet&quot;</p>
</li>
<li><p>Get the object corresponding to the sheet named &quot;MySheet&quot; and query its
<code>XSpreadsheet</code> interface</p>
<pre><code class="lang-cpp">Any aSheet = xSpreadsheets-&gt;getByName( OUString(<span class="hljs-string">&quot;MySheet&quot;</span>) );
Reference&lt; XSpreadsheet &gt; xSpreadsheet( aSheet, UNO_QUERY );
</code></pre>
</li>
<li><p>Get cells A1, A2, A3 each by using <code>getCellByPosition</code> method of <code>XCellRange</code> interface inherited <code>XSpreadsheet</code></p>
<p>Set cell A1 to 105 and A2 to 501 and insert a formula to A3 =SUM(A1:A2)</p>
<pre><code class="lang-cpp">Reference&lt; XCell &gt; xCell = xSpreadsheet-&gt;getCellByPosition(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
xCell-&gt;setValue(<span class="hljs-number">105</span>);

xCell = xSpreadsheet-&gt;getCellByPosition(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
xCell-&gt;setValue(<span class="hljs-number">501</span>);

xCell = xSpreadsheet-&gt;getCellByPosition(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>);
xCell-&gt;setFormula(<span class="hljs-string">&quot;=sum(A1:A2)&quot;</span>);
</code></pre>
</li>
<li><p>Get <code>XPropertySet</code> interface of <code>xCell</code> object which is really a <code>Cell</code> service object</p>
<pre><code class="lang-cpp">Reference&lt; XPropertySet &gt; xCellProps( xCell, UNO_QUERY );
</code></pre>
</li>
<li><p>Set the property &quot;CellStyle&quot; of A3 cell to the value &quot;Result&quot; and
the property &quot;VertJustify&quot; to the enum <code>CellVertJustify2::TOP</code></p>
<pre><code class="lang-cpp">xCellProps-&gt;setPropertyValue( OUString(<span class="hljs-string">&quot;CellStyle&quot;</span>), makeAny( OUString(<span class="hljs-string">&quot;Result&quot;</span>) ) );
xCellProps-&gt;setPropertyValue( OUString(<span class="hljs-string">&quot;VertJustify&quot;</span>), makeAny( CellVertJustify2::TOP ) );
</code></pre>
<p>Note that <code>makeAny()</code> function converts any type passed to it to <code>Any</code> type.</p>
</li>
<li><p>Get <code>XModel</code> interface from the spreadsheet component object we got in step 5)
then get <code>XController</code> interface object using <code>XModel</code>&apos;s <code>getCurrentController()</code> method
and query <code>XSpreadsheetView</code> from <code>XController</code> object. Using the <code>XSpreadsheetView</code> set the
&quot;MySheet&quot; tab to be the active one.</p>
<pre><code class="lang-cpp">Reference&lt; XModel &gt; xSpreadsheetModel( xComponent, UNO_QUERY );
Reference&lt; XController &gt; xSpreadsheetController = xSpreadsheetModel-&gt;getCurrentController();
Reference&lt; XSpreadsheetView &gt; xSpreadsheetView( xSpreadsheetController, UNO_QUERY );
xSpreadsheetView-&gt;setActiveSheet( xSpreadsheet );
</code></pre>
</li>
<li><p>Get <code>XCellRangesQuery</code> supporting object from the &quot;MySheet&quot; object.
Get the cell ranges where there are formulas in the new sheet
(we know that there is only one cell where there are formulas)
Then get the collection of formula cells in the obtained range
using <code>XEnumerationAccess</code> and <code>XEnumeration</code> interfaces.</p>
<pre><code class="lang-cpp">Reference&lt; XCellRangesQuery &gt; xCellQuery( aSheet, UNO_QUERY );
Reference&lt; XSheetCellRanges &gt; xFormulaCells = xCellQuery-&gt;queryContentCells( (<span class="hljs-keyword">short</span>)CellFlags::FORMULA );
Reference&lt; XEnumerationAccess &gt; xFormulasEnumAccess = xFormulaCells-&gt;getCells();
Reference&lt; XEnumeration &gt; xFormulaEnum = xFormulasEnumAccess-&gt;createEnumeration();
</code></pre>
</li>
<li><p>Loop over the enumerated collection of formula cells by using <code>XEnumeration</code> interface&apos;s
<code>hasMoreElements()</code> and <code>nextElement()</code> methods
Check <a href="http://api.libreoffice.org" target="_blank">http://api.libreoffice.org</a> for the signature of <code>hasMoreElements()</code> and <code>nextElement()</code> methods
as an exercise.</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">while</span> ( xFormulaEnum-&gt;hasMoreElements() )
{
    Any aNextElement = xFormulaEnum-&gt;nextElement();
    xCell = Reference&lt; XCell &gt;( aNextElement, UNO_QUERY );
    Reference&lt; XCellAddressable &gt; xCellAddress( xCell, UNO_QUERY );
    <span class="hljs-built_in">fprintf</span>( stdout, <span class="hljs-string">&quot;&gt;&gt;&gt; Formula cell in column = %d, row = %d, with formula = %s\n&quot;</span>,
             xCellAddress-&gt;getCellAddress().Column,
             xCellAddress-&gt;getCellAddress().Row,
             OUStringToOString( xCell-&gt;getFormula(), RTL_TEXTENCODING_ASCII_US ).getStr() );
    fflush( stdout );
}
</code></pre>
</li>
</ol>
<h2 id="types">Types</h2>
<p>The relation between UNO types like any, string, short etc to the corresponding C++ types can be seen at
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/FirstSteps/Common_Types" target="_blank">CommonTypes</a></p>
<p>Refer <a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/ProUNO/Data_Types" target="_blank">UNO Data Types</a> for a full coverage on
the UNO data types. Some of them are explained here.</p>
<p><strong>Struct type</strong> : These are similar to C++ struct where there are only public member variables only.
Example</p>
<p><code>::com::sun::star::beans::PropertyValue</code></p>
<p>IDL source file : PropertyValue.idl</p>
<pre><code>    module com {  module sun {  module star {  module beans {
    published struct PropertyValue
    {
        string Name;

        long Handle;

       any Value;

       com::sun::star::beans::PropertyState State;

   };

   }; }; }; };
</code></pre><p>Note : Structs should not be contructed using service manager.</p>
<p>Instantiating of a struct in C++ can be done as usual using either static allocation/dynamic allocation using new keyword</p>
<p>Example :</p>
<pre><code class="lang-cpp">   ::com::sun::star::beans::PropertyValue aProp;
   aProp.Name = OUString( <span class="hljs-string">&quot;Readonly&quot;</span> );
   aProp.Value = makeAny( ( sal_Bool )<span class="hljs-keyword">true</span> );
</code></pre>
<p>Struct may also inherit from other structs.</p>
<p><strong>Polymorphic struct</strong> : This is a struct with one or more <em>type parameters</em> and the members of this struct can have these parameters as
types.</p>
<p>Example of polymorphic struct :</p>
<pre><code>// A polymorphic struct type template with two type parameters:
struct Poly&lt;T,U&gt; {
      T member1;
      T member2;
      U member3;
      long member4;
};
</code></pre><p>Example showing the usage of polymorphic struct :</p>
<pre><code>// Using an instantiation of Poly as a UNO type:
interface XIfc { Poly&lt;boolean, any&gt; fn(); };
</code></pre><p><strong>Any type</strong> : This type can hold on to one of the C++ types that are convertible to UNO types.
To set an <code>Any</code> type variable, use <code>&lt;&lt;=</code> operator
To get from an <code>Any</code> type variable use <code>&gt;&gt;=</code> operator</p>
<p>Example :</p>
<pre><code class="lang-cpp">    sal_Int32 cellColor;
    Any any;
    any = rCellProps-&gt;getPropertyValue(OUString::createFromAscii( <span class="hljs-string">&quot;CharColor&quot;</span> ));
    <span class="hljs-comment">// extract the value from any</span>
    any &gt;&gt;= cellColor;
</code></pre>
<p><strong>Sequence type</strong> : This corresponds to &quot;sequence&quot; UNO type. This represents a homogenous collection of values of one UNO type with
variable number of elements. For remote access this interfaces that take or return &quot;sequence&quot; type is important for performance.</p>
<p>Example a) Empty sequence of <code>PropertyValue</code> struct :</p>
<pre><code class="lang-cpp">   Sequence&lt; ::com::sun::star::beans::PropertyValue &gt; loadProps;
</code></pre>
<p>Example b) Non empty sequence of <code>PropertyValue</code> structs :</p>
<pre><code class="lang-cpp">   Sequence&lt; ::com::sun::star::beans::PropertyValue &gt; loadProps( <span class="hljs-number">1</span> );
   <span class="hljs-comment">// the structs are default constructed</span>
   loadProps[<span class="hljs-number">0</span>].Name = OUString::createFromAscii( <span class="hljs-string">&quot;ReadOnly&quot;</span> );
   loadProps[<span class="hljs-number">0</span>].Value &lt;&lt;= <span class="hljs-keyword">true</span>;

   Reference&lt; XComponent &gt; rComponent = rComponentLoader-&gt;loadComponentFromURL(
                                           OUString::createFromAscii(<span class="hljs-string">&quot;private:factory/swriter&quot;</span>), 
                                           OUString::createFromAscii(<span class="hljs-string">&quot;_blank&quot;</span>), 
                                           <span class="hljs-number">0</span>, 
                                           loadProps);
</code></pre>
<h2 id="element-access">Element Access</h2>
<p>Element access is the way to access a object from a collection of objects.
The most important element access interfaces are :</p>
<ul>
<li><code>com::sun::star::container::XNameContainer</code></li>
<li><code>com::sun::star::container::XIndexContainer</code></li>
<li><code>com::sun::star::container::XEnumeration</code></li>
</ul>
<p>All these three inherit from <code>XElementAccess</code> interface and it has two methods :</p>
<pre><code>type getElementType()
boolean hasElements()
</code></pre><p><code>getElementType()</code> returns the type of elements of the container as a <code>com::sun::star::uno::Type</code> object.
If container is heterogenous it returns <code>void</code> type.</p>
<p><code>hasElements()</code> tells whether the set contains any element at all.</p>
<ol>
<li><p>Name access</p>
<p>The basic interface inherited by <code>com::sun::star::container::XNameContainer</code> is <code>com::sun::star::container::XNameAccess</code>
which has the following three methods</p>
<pre><code>any getByName( [in] string name)
sequence&lt; string &gt; getElementNames()
boolean hasByName( [in] string name)
</code></pre></li>
<li><p>Index access</p>
<p>The basic interface inherited by <code>com::sun::star::container::XIndexContainer</code> is <code>com::sun::star::container::XIndexAccess</code>
It has two methods :</p>
<pre><code>any getByIndex( [in] long index)
long getCount()
</code></pre><p>Example : <code>com::sun::star::sheet::XSpreadsheets</code> supports both Index access and Named access</p>
</li>
<li><p>Enumeration access</p>
<p>The interface <code>com::sun::star::container::XEnumerationAccess</code> creates enumerations that allow traveling across a set of objects.
It has one method:</p>
<pre><code>com::sun::star::container::XEnumeration createEnumeration()
</code></pre><p>The returned <code>XEnumeration</code> object supports two methods :</p>
<pre><code>boolean hasMoreElements()
any nextElement()
</code></pre><p>We used the above methods in getting all formula cells in the C++ program developed above.</p>
<p>In the program we used <code>XCellRangesQuery</code> interface to get cell ranges object corresponding
to cells having formulas. <code>XCellRangesQuery</code> interface defines the method :</p>
<pre><code>XSheetCellRanges queryContentCells(short cellFlags)
</code></pre><p>The returned <code>XSheetCellRanges</code> object has the following methods :</p>
<pre><code>XEnumerationAccess getCells()
String getRangeAddressesAsString()
sequence&lt; com.sun.star.table.CellRangeAddress &gt; getRangeAddresses()
</code></pre><p>We used <code>getCells()</code> to get hold of <code>XEnumerationAccess</code> object to iterate through the cells with formula.</p>
</li>
</ol>
<hr>
<h3 id="-a-name-buildsec-a-download-build-and-run-the-program"><a name="buildsec"></a>Download, build and run the program</h3>
<p>The complete C++ program can be compiled and run using :</p>
<pre><code class="lang-bash">$ git <span class="hljs-built_in">clone</span> https://github.com/niocs/ManipulateSpreadsheet.git
$ <span class="hljs-built_in">cd</span> ManipulateSpreadsheet
$ make
$ make ManipulateSpreadsheet.run
</code></pre>
<p>After running <code>make ManipulateSpreadsheet.run</code> you should see the following strings in the terminal</p>
<pre><code>remote ServiceManager is available.
opened spreadsheet document...
&gt;&gt;&gt; xSpreadsheets container has elements each of type = com.sun.star.sheet.XSpreadsheet
&gt;&gt;&gt; Formula cell in column = 0, row = 2, with formula = =SUM(A1:A2)
</code></pre><p>In addition you should see in Calc a sheet named &quot;MySheet&quot; with the following contents :</p>
<ul>
<li>Cell A1 has a number 105</li>
<li>Cell A2 has a number 501</li>
<li>Cell A3 has a formula = SUM(A1:A2) and has value = 606.</li>
</ul>
<h4 id="troubleshooting">Troubleshooting :</h4>
<p>If you see a crash and stack trace after running <code>make ManipulateSpreadsheet.run</code> like</p>
<pre><code>Application Error

Fatal exception: Signal 6
Stack:
/ssd1/work/dennis/core/instdir/program/libuno_sal.so.3(+0x63706)[0x7f9eae7c1706]
/ssd1/work/dennis/core/instdir/program/libuno_sal.so.3(+0x638ef)[0x7f9eae7c18ef]
/ssd1/work/dennis/core/instdir/program/libuno_sal.so.3(+0x63a30)[0x7f9eae7c1a30]
/lib64/libc.so.6(+0x34770)[0x7f9eae04f770]
/lib64/libc.so.6(gsignal+0x35)[0x7f9eae04f6f5]
/lib64/libc.so.6(abort+0x16a)[0x7f9eae0512fa]
...
</code></pre><p>you need to go to <code>/tmp/</code> in your machine and see if any named pipes belonging to previous LO instances (could be created by LO runs in Part1) that looks like :</p>
<pre><code>OSL_PIPE_1000_SingleOfficeIPC_1198aa9b6c6d53d496efee257b794f7
OSL_PIPE_1000_uno48105118116146272311915591153248511282101
</code></pre><p>Try removing these files before retrying the build/run instructions.</p>
<hr>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../extensions/part1.html" class="navigation navigation-prev " aria-label="Previous page: Part1"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../extensions/part3.html" class="navigation navigation-next " aria-label="Next page: Part3"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
