<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Part1 | Libreoffice Blog</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../extensions/part2.html" />
    
    
    <link rel="prev" href="../extensions/index.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    <div class="book" data-level="4.1" data-basepath=".." data-revision="Fri Sep 16 2016 18:18:56 GMT+0530 (IST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="patches/index.html">
            
                
                    <a href="../patches/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        patches
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="patches/rsu.html">
            
                
                    <a href="../patches/rsu.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Red squiggly underline bug
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="calcarch/index.html">
            
                
                    <a href="../calcarch/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Calc architecture
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="calcarch/overview.html">
            
                
                    <a href="../calcarch/overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        overview
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="calcarch/core.html">
            
                
                    <a href="../calcarch/core.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        core
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="calcarch/ui.html">
            
                
                    <a href="../calcarch/ui.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        ui
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="calcarch/filter.html">
            
                
                    <a href="../calcarch/filter.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        filter
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="misc/index.html">
            
                
                    <a href="../misc/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Libreoffice misc
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="misc/devsetup.html">
            
                
                    <a href="../misc/devsetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        devsetup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="misc/devserver.html">
            
                
                    <a href="../misc/devserver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        devserver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="misc/bibisect.html">
            
                
                    <a href="../misc/bibisect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        bibisect
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="misc/mdds.html">
            
                
                    <a href="../misc/mdds.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        mdds
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="misc/namespaces.html">
            
                
                    <a href="../misc/namespaces.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        namespaces
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="misc/patchchecklist.html">
            
                
                    <a href="../misc/patchchecklist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        patchchecklist
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="extensions/index.html">
            
                
                    <a href="../extensions/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        LibreOffice extensions
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.1" data-path="extensions/part1.html">
            
                
                    <a href="../extensions/part1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Part1
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="extensions/part2.html">
            
                
                    <a href="../extensions/part2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Part2
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="extensions/part3.html">
            
                
                    <a href="../extensions/part3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Part3
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Libreoffice Blog</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="libreoffice-extension-development-with-c-part-1-getting-to-know-uno">Libreoffice extension development with C++ - Part 1 - Getting to know UNO</h1>
<p>UNO stands for Universal Network Objects and is the base component technology for LO. For a great coverage on UNO refer to 
<a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/OpenOffice.org_Developers_Guide" target="_blank">https://wiki.openoffice.org/wiki/Documentation/DevGuide/OpenOffice.org_Developers_Guide</a>. This is mostly compatible with LO as per
LO dev wiki. This blog is heavily based on this wiki.</p>
<blockquote>
<p>UNO is used to access OpenOffice.org, using its Application Programming Interface (API). The OpenOffice.org API is the comprehensive specification that describes the programmable features of OpenOffice.org</p>
</blockquote>
<p>The LO api doc can be found at api.libreoffice.org</p>
<p>UNO can be used to :</p>
<ul>
<li>Access to a locally/remotely running LO from C++/Java program (Out-process)</li>
<li>Develop UNO components in C++/Java/Python/LO Basic that can be instantiated by LO process to add new features to it.
<strong>Example</strong> : <em>Calc Addins, Chart Addins, new file filters, database drivers</em>.</li>
<li>Write complete applications using LO like a groupware client.</li>
</ul>
<h2 id="interfaces">Interfaces</h2>
<p>An interface specifies a set of attributes and methods. An interface can inherit from a set of other interfaces.</p>
<p>Example 1 :  com.sun.star.resource.XResourceBundle ( interface defined at <a href="http://api.libreoffice.org/docs/idl/ref/XResourceBundle_8idl_source.html" target="_blank">http://api.libreoffice.org/docs/idl/ref/XResourceBundle_8idl_source.html</a> )</p>
<pre><code>module com { module sun { module star { module resource {

published interface XResourceBundle: com::sun::star::container::XNameAccess
{
   [attribute] XResourceBundle Parent;

   com::sun::star::lang::Locale getLocale();

   any getDirectElement( [in] string key );

};

}; }; }; };
</code></pre><p><code>XResourceBundle</code> interface is scoped inside <code>com::sun::star::resource</code> module.
This interface inherits the attributes/methods from <code>com::sun::star::container::XNameAccess</code> interface.
In addition it has &quot;Parent&quot; attribute and the methods <code>getLocale()</code> and <code>getDirectElement()</code>.</p>
<h2 id="services-and-service-managers">Services and Service Managers</h2>
<p>Service managers are factories that create services and services can be thought of as UNO objects that can be used to do specific tasks.</p>
<p>Examples of services :</p>
<ul>
<li><code>com::sun::star::frame::Desktop</code>  (load/access all loaded docs)</li>
<li><code>com::sun::star::configuration::ConfigurationProvider</code>  (provides access to LO config)</li>
<li><code>com::sun::star::system::SystemShellExecute</code> (can exec system commands)</li>
</ul>
<p>A service always holds on to a <strong>component context</strong> which provides access to the <em>service manager</em> that created the <em>service</em> and other data to be used by the <em>service</em>.</p>
<p>There are two types of services :</p>
<ol>
<li><p>New-style service ( single interface based services ) :</p>
<p>Example :</p>
<pre><code>module com { module sun { module star { module bridge {   
         service UnoUrlResolver: XUnoUrlResolver;
}; }; }; };
</code></pre><p>In this example <code>UnoUrlResolver</code> service is scoped under the module <code>com::sun::star::bridge</code> and it supports <code>XUnoUrlResolver</code> interface.</p>
</li>
<li><p>Old-style service/accumalation based service : (not to be used for new additions but support present for backward compatibility)</p>
<p>Example :</p>
<pre><code>module com { module sun { module star { module frame { service DesktopOld {
   service FrameOld;
   interface XDesktop;
   interface XComponentLoader;
   interface com::sun::star::document::XEventBroadcaster;
};
}; }; }; };
</code></pre><p>The service <code>DesktopOld</code> supports all interfaces exported (<code>XDesktop</code> <code>XComponentLoader</code> <code>XEventBroadcaster</code>) and inherited services (<code>FrameOld</code>)
Additionally an old-style service may specify one or more <em>properties</em> like :</p>
<pre><code>module com { module sun { module star { module frame { service FrameOld {   
   interface com::sun::star::frame::XFrame;
   interface com::sun::star::frame::XDispatchProvider;
   // ...
   [property] string Title;
   [property, optional] XDispatchRecorderSupplier RecorderSupplier;
   // ...
};
}; }; }; };
</code></pre><p><strong>Properties</strong> are like <em>attributes</em> of an interface except that they can&apos;t be accessed directly. They can be accessed via generic interfaces like
<code>com.sun.star.beans.XPropertySet</code>. <code>XPropertySet</code> is always supported when properties are present in service.
Properites are used to represent <em>additional</em> features provided by the service.
<code>XPropertySet</code> has the following methods :</p>
<p>a.</p>
<pre><code>  any getPropertyValue( [in] string PropertyName )
        raises( com::sun::star::beans::UnknownPropertyException,
         com::sun::star::lang::WrappedTargetException );
</code></pre><p>b.</p>
<pre><code>  void setPropertyValue( [in] string aPropertyName,
                    [in] any aValue )
      raises( com::sun::star::beans::UnknownPropertyException,
               com::sun::star::beans::PropertyVetoException,
               com::sun::star::lang::IllegalArgumentException,
       com::sun::star::lang::WrappedTargetException );
</code></pre><p><code>any</code> in interface definition language corresponds the class <code>com::sun::star::uno::Any</code>
See <a href="http://opengrok.libreoffice.org/xref/core/include/com/sun/star/uno/Any.hxx" target="_blank">Any.hxx</a>.
Also see <a href="http://api.libreoffice.org/docs/cpp/ref/a00264.html" target="_blank">api-reference</a>.</p>
</li>
</ol>
<p>Services can also contain optional interfaces. This means the service implementation need not implement those interfaces. So when we get objects corresponding
to optional interfaces from service objects via UNO_QUERY, we should check if the returned Reference is null pointer as shown below.</p>
<pre><code class="lang-cpp">Reference&lt;OptionalInterface&gt; result(xExampleServiceObject, UNO_QUERY);
<span class="hljs-keyword">if</span> ( !result.is() ) {
   <span class="hljs-comment">// The optional interface is not implemented, so do fallback procedure or raise exception.</span>
   <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
}
<span class="hljs-comment">// Use the &apos;result&apos; object</span>
</code></pre>
<p>New style services can have constructors similar to interface methods.</p>
<pre><code>service SomeService: XSomeInterface { 
      create1();
      create2([in] long arg1, [in] string arg2);
      create3([in] any... rest);
};
</code></pre><p>In this example there are three explicit constructors : <code>create1</code>, <code>create2</code>, <code>create3</code>. Unlike interface methods, service constructors do not
specify a return type.
The implementation of these constructors would take the component context object of type <code>com::sun::star::uno::XComponentContext</code> as first parameter followed
by any explicit parameters. The service constructors can also have exception specifications (<code>raises (Exception1, Exception2)</code>). If the constructor has no
exception specification, it may only throw runtime exceptions in particular <code>com::sun::star::uno::DeploymentException</code>.</p>
<p>If the service specification has no explicit constructor, then the implicit constructor is used for creating its objects which language binding specific but it is
generally named as <code>create</code>. This takes no argument besides <code>com::sun::star::uno::XComponentContext</code></p>
<p>Refer <a href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/ProUNO/Services" target="_blank">Service</a></p>
<blockquote>
<p> The concepts of interfaces and services were introduced for the following reasons :</p>
<p> 1)  Interfaces and services separate specification from implementation.</p>
<p> 2)  Service names allow to create instances by specification name, not by class names.</p>
</blockquote>
<h2 id="component">Component</h2>
<blockquote>
<p>A <strong>component</strong> is a shared library or Java archive containing implementations of one or more services in one of the target programming languages supported by UNO. Such a component must meet basic requirements, mostly different for the different target language, and it must support the specification of the implemented services. That means all specified interfaces and properties must be implemented. Components must be registered in the UNO runtime system. After the registration all implemented services can be used by ordering an instance of the service at the appropriate service factory and accessing the functionality over interfaces.</p>
</blockquote>
<h2 id="component-context">Component Context</h2>
<p>Component context is a read-only container offering named values. One of the named values is service manager. When a new component is created the <em>component context</em> is passed to it. It can also be
viewed as an environment where all components live.</p>
<p>See the below diagram from OOO wiki showing relationship between Component context and service managers :
<img src="https://wiki.openoffice.org/w/images/thumb/c/c2/UseServices1.png/800px-UseServices1.png" alt="Component context" title="ComponentContext and the ServiceManager"></p>
<p>The component context supports <code>com::sun::star::uno::XComponentContext</code> interface.</p>
<pre><code>// module com::sun::star::uno
interface XComponentContext : XInterface
{
      any getValueByName( [in] string Name );
      com::sun::star::lang::XMultiComponentFactory getServiceManager();
};
</code></pre><p><code>getServiceManager()</code> returns the singleton com::sun::star::lang::ServiceManager.
<code>getValueByName()</code> returns named value. The named values can be:</p>
<ol>
<li><em>Singletons</em> : Example ServiceManager</li>
<li><em>Implementation properties</em></li>
<li><em>Service properties</em></li>
</ol>
<h2 id="setup-lo-sdk-after-building-lo">Setup LO SDK after building LO</h2>
<p>Go to $LOROOT/instdir/sdk and run :</p>
<pre><code>$ ./setsdkenv_unix
</code></pre><p>hit enter for all questions, letting it use the defaults except for &quot;Automatic deployment of UNO components (YES/NO) [YES]: &quot; type NO.</p>
<p>This will show something like the following after it finishes.</p>
<pre><code> ************************************************************************
 * ... your SDK environment has been prepared.
 * For each time you want to use this configured SDK environment, you
 * have to run the &quot;setsdkenv_unix&quot; script file!
 * Alternatively can you source one of the scripts
 *   &quot;/home/dennis/libreoffice5.3_sdk/dennis-work/setsdkenv_unix.sh&quot;
 * to get an environment without starting a new shell.
 ************************************************************************


 ************************************************************************
 *
 * SDK environment is prepared for Linux
 *
 * SDK = /ssd1/work/dennis/core/instdir/sdk
 * Office = /ssd1/work/dennis/core/instdir/sdk/..
 * Make = /usr/bin
 * Zip = /usr/bin
 * cat = /usr/bin
 * sed = /usr/bin
 * C++ Compiler = /usr/bin
 * Java = /usr
 * SDK Output directory = /home/dennis/libreoffice5.3_sdk
 * Auto deployment = NO
 *
 ************************************************************************
</code></pre><p>First section says that <strong>we need to</strong></p>
<pre><code class="lang-bash">$ <span class="hljs-built_in">source</span> /home/dennis/libreoffice5.<span class="hljs-number">3</span>_sdk/dennis-work/setsdkenv_unix.sh
</code></pre>
<p>in shell <strong>before</strong> trying to build our own extensions/UNO standalone programs.</p>
<h2 id="example-c-program-that-shows-how-to-access-lo-from-a-standalone-program">Example C++ program that shows how to access LO from a standalone program</h2>
<pre><code class="lang-cpp"><span class="hljs-comment">// This program is a simplified version of</span>
<span class="hljs-comment">// http://api.libreoffice.org/examples/DevelopersGuide/ProfUNO/SimpleBootstrap_cpp/SimpleBootstrap_cpp.cxx</span>

<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;stdio.h&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;sal/main.h&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;cppuhelper/bootstrap.hxx&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;com/sun/star/lang/XMultiComponentFactory.hpp&gt;</span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> com::sun::star::uno;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> com::sun::star::lang;

<span class="hljs-keyword">using</span> ::rtl::OString;
<span class="hljs-keyword">using</span> ::rtl::OUString;
<span class="hljs-keyword">using</span> ::rtl::OUStringToOString;

SAL_IMPLEMENT_MAIN()
{
    <span class="hljs-keyword">try</span>
    {
        <span class="hljs-comment">// get the remote office component context</span>
        Reference&lt; XComponentContext &gt; xContext( ::cppu::bootstrap() );
        <span class="hljs-keyword">if</span> ( !xContext.is() )
        {
            <span class="hljs-built_in">fprintf</span>(stdout, <span class="hljs-string">&quot;\nError getting context from running LO instance...\n&quot;</span>);
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        }

        <span class="hljs-comment">// retrieve the service-manager from the context</span>
        Reference&lt; XMultiComponentFactory &gt; rServiceManager = xContext-&gt;getServiceManager();
        <span class="hljs-keyword">if</span> ( rServiceManager.is() )
            <span class="hljs-built_in">fprintf</span>(stdout, <span class="hljs-string">&quot;\nremote ServiceManager is available\n&quot;</span>);
        <span class="hljs-function"><span class="hljs-keyword">else</span>
            <span class="hljs-title">fprintf</span><span class="hljs-params">(stdout, &quot;\nremote ServiceManager is not available\n&quot;)</span></span>;
        fflush(stdout);
    }
    <span class="hljs-keyword">catch</span> ( ::cppu::BootstrapException&amp; e )
    {
        <span class="hljs-built_in">fprintf</span>(stderr, <span class="hljs-string">&quot;caught BootstrapException: %s\n&quot;</span>,
                OUStringToOString( e.getMessage(), RTL_TEXTENCODING_ASCII_US ).getStr());
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">catch</span> ( Exception&amp; e )
    {
        <span class="hljs-built_in">fprintf</span>(stderr, <span class="hljs-string">&quot;caught UNO exception: %s\n&quot;</span>,
                OUStringToOString( e.Message, RTL_TEXTENCODING_ASCII_US ).getStr());
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

}
</code></pre>
<p>How to build and run this program ?</p>
<pre><code class="lang-bash">$ git <span class="hljs-built_in">clone</span> https://github.com/niocs/SimpleBootstrapCppUNO.git
$ make
$ make SimpleBootstrap.run
</code></pre>
<h2 id="objects-in-lo">Objects in LO</h2>
<blockquote>
<p>In UNO, an object is a software artifact that has methods that you can call and attributes that you can get and set.</p>
</blockquote>
<p>An <strong>object</strong> is a result of implementation of <em>services</em> which follows a set of <em>interfaces</em>.</p>
<p><em>Objects</em> are created by <em>service managers</em>. Following shows how to create a <code>Desktop</code> <em>service</em> object :</p>
<pre><code class="lang-cpp">Reference&lt; XInterface &gt; xDesktop = xServiceManager-&gt;createInstanceWithContext( OUString(<span class="hljs-string">&quot;com.sun.star.frame.Desktop&quot;</span>), xContext );
</code></pre>
<p>The returned object is casted as <code>XInterface</code> interface even though the <code>Desktop</code> service implements <code>XDesktop2</code> interface.
See <a href="http://api.libreoffice.org/docs/idl/ref/servicecom_1_1sun_1_1star_1_1frame_1_1Desktop.html" target="_blank">Desktop api reference</a></p>
<p><code>Document</code> objects are ones that represent the docs opened with LO. These are created by <code>Desktop</code> service object using <code>loadComponentFromURL()</code></p>
<pre><code class="lang-cpp">Reference&lt; XDesktop2 &gt; xDesktop2( xDesktop, UNO_QUERY ); <span class="hljs-comment">// Upcast previously created XInterface type</span>
Reference&lt; XComponent &gt; xComponent = xDesktop2-&gt;loadComponentFromURL(
                                      OUString( <span class="hljs-string">&quot;private:factory/scalc&quot;</span> ), <span class="hljs-comment">// URL to the ods file</span>
                                      OUString( <span class="hljs-string">&quot;_blank&quot;</span> ), <span class="hljs-number">0</span>,
                                      Sequence &lt; ::com::sun::star::beans::PropertyValue &gt;() );
</code></pre>
<p>The complete C++ program that creates a Desktop object and loads an empty calc document can be built and run as :</p>
<pre><code class="lang-bash">$ git <span class="hljs-built_in">clone</span> https://github.com/niocs/UNOCreateUseObject.git
$ make
$ make CreateUseObject.run
</code></pre>
<p>The above is an example of getting an object from another object. There are two different cases for getting objects from other objects :</p>
<ol>
<li><p>Objects(special ones) that are related to features that are integral part of an object can be obtained by get*() methods.
For example <code>getSheets()</code> gives sheets object for a calc document, <code>getText()</code> for a writer document, <code>getDrawpages()</code> for Draw document.
After loading a document these methods can be used to get Sheets/Text/Drawpages objects of corresponding document.</p>
</li>
<li><p>Objects that are not considered integral part of an object are accessible through a set of &quot;universal&quot; methods such as
<code>Any getPropertyValue( OUString aPropertyName )</code> (these objects are considered as properties of the main object)
The type <code>Any</code> is explained in next part.</p>
</li>
</ol>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../extensions/index.html" class="navigation navigation-prev " aria-label="Previous page: LibreOffice extensions"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../extensions/part2.html" class="navigation navigation-next " aria-label="Next page: Part2"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
